swagger: '2.0'
info:
  version: 0.19.0
  title: PickUp Node API
  description: PickUp's Node API
paths:
  /props:
    get:
      description: Returns a collection of props
      parameters:
        - in: query
          name: id
          type: integer
          description: ID of prop to return
          required: false
        - in: query
          name: limit
          type: integer
          description: Set a limit to the number of props returned per page
          required: false
        - in: query
          name: offset
          type: integer
          description: Number of props to skip over when returning props
          required: false
        - in: query
          name: token
          type: string
          required: true

      responses:
        200:
          description: Successfully returned a list of props - THIS OUTPUT WILL CHANGE AND IS NOT SOLIDIFIED
          schema:
            type: array
            items:
              type: object
              properties:
                id:
                  type: integer
                  example: 3829
                proposition:
                  type: string
                  example: "Fowler's Batting Average for 2021"
                iframe_html:
                  type: string
                  example: '<iframe src="https://app.playpickup.com//widgets/props/4768" style="width: 352px; height: 504px; margin-bottom: 0; border: none" referrerpolicy="unsafe-url" sandbox="allow-popups allow-scripts allow-same-origin allow-forms" width="352px" height="504px" resizable></iframe>'
                picks:
                  type: array
                  items:
                    type: object
                    properties:
                      id:
                        type: number
                        example: 10531
                      title:
                        type: string
                        example: "Dexter Fowler's final batting average for 2021 will be over .270"

        403:
          description: Permission Denied
          schema:
            type: object
            properties:
              message:
                type: string
                example: 'Forbidden'

  /props/closing:
    get:
      description: Returns a collection of props that are closing in the next 48 hours
      parameters:
        - in: query
          name: token
          type: string
          required: true

      responses:
        200:
          description: Successfully returned a list of props closing within 48 hours
          schema:
            type: array
            items:
              type: object
              properties:
                id:
                  type: integer
                  example: 4035
                close_time:
                  type: string
                  example: '2021-05-20T01:18:00.000Z'
                proposition:
                  type: string
                  example: 'Will Steph Curry be traded?'
                created_at:
                  type: string
                  example: '2021-01-20T01:18:12.689Z'
                updated_at:
                  type: string
                  example: '2021-01-20T01:18:12.689Z'

        403:
          description: Permission Denied
          schema:
            type: object
            properties:
              message:
                type: string
                example: 'Forbidden'

  /publishers/demo:
    post:
      description: 'Sends a publisher demo request email to the content team'
      consumes:
        - application/x-www-form-urlencoded
      parameters:
        - in: formData
          name: publisherEmail
          type: string
          description: User entered email
        - in: query
          name: token
          type: string
          required: true
      responses:
        200:
          description: Successfully sent demo request
          schema:
            type: object
            properties:
              code:
                type: integer
                example: 0
                
  /publishers/posts:
    delete:
      description: Deletes a homebase post created by the requesting publisher, publishers can only delete their own posts
      parameters:
        - in: query
          name: token
          description: Publisher Access Token
          type: string
        - in: query
          name: publisher_id
          description: Publisher ID
          type: integer
        - in: query
          name: post_id
          description: Post ID to delete
          type: integer
      responses:
        200:
          description: OK
          schema: 
            type: object
            properties: 
              message: 
                type: string
                example: Deleted
        400:
          description: Bad Request
          schema:
            type: object
            properties:
              message:
                type: string
                example: 'Bad Request'
    

  /leagues:
    get:
      description: 'Returns a collection of currently supported leagues'
      responses:
        200:
          description: 'Successfully returned a collection of supported leagues'
          schema:
            type: array
            items:
              type: object
              properties:
                value:
                  type: string
                  example: 'mlb'
                label:
                  type: string
                  example: 'MLB'
        403:
          description: Permission Denied
          schema:
            type: object
            properties:
              message:
                type: string
                example: 'Forbidden'
  /leagues/postCount:
    get:
      description: 'Returns a number of active posts that exist under passed league(s)'
      parameters:
        - in: query
          name: token
          type: string
          required: true
        - in: query
          name: league
          type: string
          required: true
      responses:
        200:
          description: 'Successfully returned a count of active posts for league(s)'
          schema:
            type: array
            items:
              type: object
              properties: 
                count: 
                  type: string
                  example: "23"
        403:
          description: Permission Denied
          schema:
            type: object
            properties:
              message:
                type: string
                example: 'Forbidden'
  /users:
    get:
      description: 'Returns a collection of PickUp admin users'
      parameters:
        - in: query
          name: id
          type: integer
          description: ID of user to return
      responses:
        200:
          description: 'Successfully returned a collection of PickUp admin users'
          schema:
            type: array
            items:
              type: object
              properties:
                id:
                  type: integer
                  example: 420
                first_name:
                  type: string
                  example: Archie
                last_name:
                  type: string
                  example: Bradley
                email:
                  type: string
                  example: a.bradley@mlb.com
                avatar:
                  type: string
                  example: headshot.jpg
  /buckets:
    get: 
      description: Gets a collection of Post Bukcets
      parameters:
        - in: query
          name: id
          type: integer
          description: Gets a bucket by ID
        - in: query
          name: location
          type: string
          description: 'Gets buckets by location'
        - in: query
          name: token
          type: string
          required: true
          description: 'Active publisher token'
      responses:
        200:
          description: 'Successfully returned collection of Post Buckets'
          schema:
            type: array
            items: 
              type: object
              properties:
                id:
                  type: integer
                  example: 23
                title:
                  type: string
                  example: "J.J. Watt to the Cards!"
                position:
                  type: string
                  example: 'homepage'
                created_by_id:
                  type: integer
                  example: 2
                  description: 'Admin user who created the bucket'
                created_at:
                  type: string
                  example: '2021-04-01T19:37:20.531Z'
                updated_at:
                  type: string
                  example: '2021-04-01T20:37:20.531Z'
                deleted_at:
                  type: string
                  example: '2021-04-20T19:37:20.531Z'
        400:
          description: Bad request, did you pass an access token?
          schema:
            type: object
            properties: 
              message:
                type: string
                example: 'Bad Request'
    post:
      description: Creates a Post Bucket
      consumes:
        - application/json
      parameters:
      - in: query
        name: token
        type: string
        description: Admin token
        required: true
      - in: body
        name: post
        description: Creates a PickUp Post Bucket with supplied properties
        schema:
          type: object
          required:
            - title
            - position
          properties:
            title:
              type: string
              example: 'J.J. Watts to the Cards!'
            position: 
              type: string
              example: 'homepage'
            updated_at:
              type: string
              example: '2021-04-20T19:37:20.531Z'
            deleted_at:
              type: string
              example: '2021-04-20T19:37:20.531Z'
      responses:
        201:
          description: 'Successfully created bucket'
          schema:
            type: object
            properties:
              message:
                type: string
                example: Created
              id:
                type: integer
                example: 23
        400:
          description: Bad Request
          schema:
            type: object
            properties:
              message:
                type: string
                example: Bad Request
                
    put:
      description: Updates a Post Bucket
      consumes:
        - application/json
      parameters:
      - in: query
        name: token
        type: string
        description: Admin token
        required: true
      - in: query
        name: id
        type: integer
        description: ID of the Post Bucket to update
        required: true
      - in: body
        name: post
        description: Updates a PickUp Post Bucket with supplied properties
        schema:
          type: object
          required:
            - title
            - position
          properties:
            title:
              type: string
              example: 'J.J. Watts to the Cards!'
            position: 
              type: string
              example: 'homepage'
            updated_at:
              type: string
              example: '2021-04-20T19:37:20.531Z'
            deleted_at:
              type: string
              example: '2021-04-20T19:37:20.531Z'
      responses:
        200:
          description: 'Successfully updated bucket'
          schema:
            type: object
            properties:
              message:
                type: string
                example: Updated
              id:
                type: integer
                example: 23
        400:
          description: Bad Request
          schema:
            type: object
            properties:
              message:
                type: string
                example: Bad Request
                
    delete:
      description: Deletes a Post Bucket
      consumes:
        - application/json
      parameters:
      - in: query
        name: token
        type: string
        description: Admin token
        required: true
      - in: query
        name: id
        type: integer
        description: ID of the Post Bucket to delete
        required: true
      responses:
        200:
          description: 'Successfully deleted bucket'
          schema:
            type: object
            properties:
              message:
                type: string
                example: Deleted
        400:
          description: Bad Request
          schema:
            type: object
            properties:
              message:
                type: string
                example: Bad Request
  
  /buckets-posts:
    post:
      description: 'Creates post association with a specific Bucket'
      consumes:
        - application/json
      parameters:
        - in: query
          name: token
          type: string
          description: Publisher Token
          required: true
        - in: body
          name: body
          description: Attaches a post to a Bucket
          required: true
          schema:
            type: object
            required:
              - bucket_id
              - post_id
            properties:
              bucket_id:
                type: integer
                example: 23
              post_id:
                type: integer
                example: 5843
              order:
                type: integer
                example: 2
      responses:
        200:
          description: 'Successfully attached post to bucket'
          schema: 
            type: object
            properties:
              message:
                type: string
                example: Created
        400:
          description: 'Could not attach post to bucket'
          schema: 
            type: object
            properties:
              message:
                type: string
                example: Bad Request
    patch:
      description: 'Creates post association with a specific Bucket'
      consumes:
        - application/json
      parameters:
        - in: query
          name: token
          type: string
          description: Publisher Token
          required: true
        - in: query
          name: post_id
          type: integer
          description: "`post_id` on `bucket_post` record to update, **note**: this is not the `id` for the record istelf"
          required: true
        - in: query
          name: bucket_id
          type: integer
          description: "bucket_id to target"
          required: true
        - in: body
          name: body
          description: Payload to update
          required: true
          schema:
            type: object
            properties:
              bucket_id:
                type: integer
                example: 23
              post_id:
                type: integer
                example: 5843
              order:
                type: integer
                example: 2
      responses:
        200:
          description: 'Successfully updated bucket_post record'
          schema: 
            type: object
            properties:
              message:
                type: string
                example: Updated
        400:
          description: 'Could not update post bucket record'
          schema: 
            type: object
            properties:
              message:
                type: string
                example: Bad Request
    delete:
      description: 'Deletes post association with a specific Bucket. **NOTE**: This only removes the association with the bucket and does not modify the post record in any form.'
      consumes:
        - application/json
      parameters:
        - in: query
          name: token
          type: string
          description: Admin Token
          required: true
        - in: query
          name: id
          type: number
          description: id of buckets_posts record to delete
          required: true

      responses:
        200:
          description: 'Successfully removed post from bucket'
          schema: 
            type: object
            properties:
              message:
                type: string
                example: Deleted
        400:
          description: 'Could not dettach post from bucket'
          schema: 
            type: object
            properties:
              message:
                type: string
                example: Bad Request
                  
  /posts:
    get:
      description: 'Returns a collection of PickUp Posts'
      parameters:
        - in: query
          name: limit
          type: integer
          description: Limit the number of posts to return
        - in: query
          name: offset
          type: integer
          description: Number of posts to skip over in response
        - in: query
          name: id
          type: array
          items:
            type: string
          description: Returns post or posts with matching ID(s)
        - in: query
          name: article_url
          type: string
          description: Returns post or posts with matching article_url values
        - in: query
          name: league
          type: string
          description: Returns league specific posts matching league name
        - in: query
          name: prop_id
          type: integer
          description: Returns post or posts with matching prop_id value
        - in: query
          name: search
          type: string
          description: 'Searches `post_title` and `headline` columns for relevant strings. **NOTE**: League query has no effect when using search query'
        - in: query
          name: token
          type: string
          required: true
      responses:
        200:
          description: 'Successfully returned a collection of PickUp Posts'
          schema:
            type: array
            items:
              type: object
              properties:
                id:
                  type: integer
                  example: 23
                post_title:
                  type: string
                  example: 'Will Steph Curry be traded?'
                league:
                  type: array
                  items:
                    type: string
                    example: NBA
                prop_id:
                  type: integer
                  example: 4032
                article_url:
                  type: string
                  example: 'https://nba.com/news/2020/02/14/warriors-next-moves-steph-curry'
                headline:
                  type: string
                  example: 'With a dissapointing season in the books, what are the Warriors next moves?'
                excerpt:
                  type: string
                  example: 'The Champions no more, the Warriors are wondering where it all broke down. Despite an impressive performance from Curry the shortcommings are too blinding to ignore.'
                featured_img:
                  type: string
                  example: 'https://aws.bucket.fake.pckp.io/posts/390382084.jpg'
                published_at:
                  type: string
                  example: '2021-01-20T01:18:12.689Z'
                updated_at:
                  type: string
                  example: '2021-01-20T01:18:12.689Z'
                deleted_at:
                  type: string
                  example: null
                publisher_name:
                  type: string
                  example: 'NBA Analysis Network'
                author_id:
                  type: integer
                  example: null
                publisher_source_url:
                  type: string
                  example: 'https://www.nbaanalysis.net'
                publisher_logo:
                  type: string
                  example: 'nbaanalysislogo.jpg'
                publisher_id:
                  type: integer
                  example: 3
                slug:
                  type: string
                  example: 'warriors-next-moves-steph-curry-4032'

        403:
          description: Permission Denied
          schema:
            type: object
            properties:
              message:
                type: string
                example: 'Forbidden'
    post:
      description: Creates a PickUp Post (Currently referred to as Homebase Post)
      consumes:
        - application/json
      parameters:
        - in: body
          name: post
          description: Creates a PickUp Post with supplied properties
          schema:
            type: object
            required:
              - post_title
              - league
              - prop_id
              - article_url
              - headline
              - excerpt
              - featured_img
            properties:
              post_title:
                type: string
              league:
                type: array
                items:
                  type: string
              prop_id:
                type: integer
              article_url:
                type: string
              headline:
                type: string
              excerpt:
                type: string
              featured_img:
                type: string
        - in: query
          name: token
          type: string
          required: true
      responses:
        201:
          description: Successfully created a PickUp Post
          schema:
            type: object
            properties:
              message:
                type: string
                example: 'Created'
        403:
          description: Permission Denied
          schema:
            type: object
            properties:
              message:
                type: string
                example: 'Forbidden'

    put:
      description: Updates an entire PickUp Post Record
      consumes:
        - application/json
      parameters:
        - in: body
          name: post
          description: Updates a PickUp Post with supplied properties
          schema:
            type: object
            required:
              - post_title
              - league
              - prop_id
              - article_url
              - headline
              - excerpt
              - featured_img
            properties:
              post_title:
                type: string
              league:
                type: array
                items:
                  type: string
              prop_id:
                type: integer
              article_url:
                type: string
              headline:
                type: string
              excerpt:
                type: string
              featured_img:
                type: string
        - in: query
          name: token
          type: string
          required: true

      responses:
        201:
          description: Successfully updated a PickUp Post
          schema:
            type: object
            properties:
              message:
                type: string
                example: 'Updated'
        403:
          description: Permission Denied
          schema:
            type: object
            properties:
              message:
                type: string
                example: 'Forbidden'

    delete:
      description: Deletes an entire PickUp Post Record
      consumes:
        - application/json
      parameters:
        - in: query
          name: id
          type: integer
          description: ID of post to delete
          required: true
        - in: header
          name: 'x-PickUp-Access-Token'
          type: string
          required: true

      responses:
        201:
          description: Successfully updated a PickUp Post
          schema:
            type: object
            properties:
              message:
                type: string
                example: 'Deleted'
        403:
          description: Permission Denied
          schema:
            type: object
            properties:
              message:
                type: string
                example: 'Forbidden'
                
  /picks:
    get:
      description: Gets picks from the database (picks have a many relationship to props)
      parameters:
        - in: query
          name: token
          description: Admin token
          type: string
          required: true
        - in: query
          name: prop_id
          description: Filters picks by prop_id
          type: integer
      responses:
        200:
          description: OK
          schema:
            type: array
            items:
              type: object
              properties:
                id:
                  type: integer
                  example: 2323
                title:
                  type: string
                  example: 'Celtics beat the Bucks on 3/24'
                created_at:
                  type: string
                  example: '2021-03-20 01:08:25.530295'
                updated_at:
                  type: string
                  example: '2021-03-20 01:08:25.530295'
                state:
                  type: string
                  example: 'pending'
                fan_picks_count:
                  type: number
                  example: 51
                user_id:
                  type: number
                  example: 2
                graded_at:
                  type: string
                  example: '2021-03-13 18:13:58.140031'
                  
  /stats/posts-by-day:
    get: 
      description: Gets all posts grouped by days
      parameters:
        - in: query
          name: token
          description: Admin token
          type: string
          required: true
      responses:
        200:
          description: OK
          schema:
            type: array
            items:
              type: object
              properties:
                date:
                  type: integer
                  example: 34
                
        400:
          description: 'Bad Request'
          schema: 
            type: object
            properties:
              message:
                type: string
                example: Bad Request
    
    

# Added by API Auto Mocking Plugin
# host: api.playpickup.com
# basePath: /v1
schemes:
  - https
# Added by API Auto Mocking Plugin
host: virtserver.swaggerhub.com
basePath: /stoutatpickup/pickup-node-api/0.1.0